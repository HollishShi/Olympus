define("dom/mask/MaskEntity",["require","exports","engine/bridge/BridgeManager","DOMBridge"],function(require,exports,BridgeManager_1,DOMBridge_1){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var MaskEntityImpl=function(){function MaskEntityImpl(params){this._showing=false;if(params){if(typeof params.loadingSkin=="string"){var temp=document.createElement("div");temp.innerHTML=params.loadingSkin;params.loadingSkin=temp}this.loadingSkin=params.loadingSkin}this.maskData=params||{}}MaskEntityImpl.prototype.showMask=function(alpha){};MaskEntityImpl.prototype.hideMask=function(){};MaskEntityImpl.prototype.isShowingMask=function(){return false};MaskEntityImpl.prototype.showLoading=function(alpha){if(this.loadingSkin==null||this._showing)return;this._showing=true;var bridge=BridgeManager_1.bridgeManager.getBridge(DOMBridge_1.default.TYPE);bridge.addChild(bridge.maskLayer,this.loadingSkin)};MaskEntityImpl.prototype.hideLoading=function(){if(this.loadingSkin==null||!this._showing)return;this._showing=false;var bridge=BridgeManager_1.bridgeManager.getBridge(DOMBridge_1.default.TYPE);bridge.removeChild(bridge.maskLayer,this.loadingSkin)};MaskEntityImpl.prototype.isShowingLoading=function(){return this._showing};MaskEntityImpl.prototype.showModalMask=function(panel,alpha){};MaskEntityImpl.prototype.hideModalMask=function(panel){};MaskEntityImpl.prototype.isShowingModalMask=function(panel){return false};return MaskEntityImpl}();exports.default=MaskEntityImpl});define("dom/utils/SkinUtil",["require","exports","engine/assets/AssetsManager"],function(require,exports,AssetsManager_1){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function wrapSkin(mediator,skin){var result;if(skin instanceof HTMLElement){result=skin}else{result=document.createElement("div");var oriFunc=mediator.hasOwnProperty("onOpen")?mediator.onOpen:null;mediator.onOpen=function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i]}if(skin instanceof Array){skin=skin.map(getContent).join("")}result.innerHTML=skin;var reg=/id=("([^"]+)"|'([^']+)')/g;var res;while(res=reg.exec(skin)){var id=res[2]||res[3];mediator[id]=result.querySelector("#"+id)}if(oriFunc)mediator.onOpen=oriFunc;else delete mediator.onOpen;mediator.onOpen.apply(this,args)}}mediator.skin=result;return result}exports.wrapSkin=wrapSkin;function getContent(skin){if(skin.indexOf("<")>=0&&skin.indexOf(">")>=0){return skin}else{return AssetsManager_1.assetsManager.getAssets(skin)}}});define("dom/injector/Injector",["require","exports","utils/ConstructUtil","engine/injector/Injector","engine/bridge/BridgeManager","dom/utils/SkinUtil","DOMBridge"],function(require,exports,ConstructUtil_1,Injector_1,BridgeManager_2,SkinUtil_1,DOMBridge_2){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function DOMMediatorClass(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i]}if(args[0]instanceof Function){var cls=Injector_1.MediatorClass(args[0]);ConstructUtil_1.listenConstruct(cls,function(mediator){return mediator.bridge=BridgeManager_2.bridgeManager.getBridge(DOMBridge_2.default.TYPE)});return cls}else{return function(cls){cls=Injector_1.MediatorClass(cls);ConstructUtil_1.listenConstruct(cls,function(mediator){return SkinUtil_1.wrapSkin(mediator,args)});return cls}}}exports.DOMMediatorClass=DOMMediatorClass});define("DOMBridge",["require","exports","utils/ObjectUtil","engine/assets/AssetsManager","dom/mask/MaskEntity"],function(require,exports,ObjectUtil_1,AssetsManager_2,MaskEntity_1){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var DOMBridge=function(){function DOMBridge(params){this.defaultPanelPolicy=null;this.defaultScenePolicy=null;this._listenerDict={};this._initParams=params}Object.defineProperty(DOMBridge.prototype,"type",{get:function(){return DOMBridge.TYPE},enumerable:true,configurable:true});Object.defineProperty(DOMBridge.prototype,"htmlWrapper",{get:function(){return this._initParams.container},enumerable:true,configurable:true});Object.defineProperty(DOMBridge.prototype,"root",{get:function(){return this._initParams.container},enumerable:true,configurable:true});Object.defineProperty(DOMBridge.prototype,"stage",{get:function(){return this.root.ownerDocument},enumerable:true,configurable:true});Object.defineProperty(DOMBridge.prototype,"bgLayer",{get:function(){return this._initParams.container},enumerable:true,configurable:true});Object.defineProperty(DOMBridge.prototype,"sceneLayer",{get:function(){return this._initParams.container},enumerable:true,configurable:true});Object.defineProperty(DOMBridge.prototype,"frameLayer",{get:function(){return this._initParams.container},enumerable:true,configurable:true});Object.defineProperty(DOMBridge.prototype,"panelLayer",{get:function(){return this._initParams.container},enumerable:true,configurable:true});Object.defineProperty(DOMBridge.prototype,"maskLayer",{get:function(){return this._initParams.container},enumerable:true,configurable:true});Object.defineProperty(DOMBridge.prototype,"topLayer",{get:function(){return this._initParams.container},enumerable:true,configurable:true});Object.defineProperty(DOMBridge.prototype,"promptClass",{get:function(){return this._initParams.promptClass},enumerable:true,configurable:true});Object.defineProperty(DOMBridge.prototype,"maskEntity",{get:function(){return new MaskEntity_1.default(this._initParams.maskData)},enumerable:true,configurable:true});DOMBridge.prototype.init=function(complete){if(typeof this._initParams.container=="string"){this._initParams.container=document.querySelector(this._initParams.container)}if(!this._initParams.container){this._initParams.container=document.createElement("div");document.body.appendChild(this._initParams.container)}complete(this)};DOMBridge.prototype.isMySkin=function(skin){return skin instanceof HTMLElement};DOMBridge.prototype.createEmptyDisplay=function(){return document.createElement("div")};DOMBridge.prototype.addChild=function(parent,target){return parent.appendChild(target)};DOMBridge.prototype.addChildAt=function(parent,target,index){return parent.insertBefore(target,this.getChildAt(parent,index))};DOMBridge.prototype.removeChild=function(parent,target){return parent.removeChild(target)};DOMBridge.prototype.removeChildAt=function(parent,index){return parent.removeChild(this.getChildAt(parent,index))};DOMBridge.prototype.removeChildren=function(parent){for(var i=0,len=parent.children.length;i<len;i++){parent.removeChild(parent.children.item(i))}};DOMBridge.prototype.getParent=function(target){return target.parentElement};DOMBridge.prototype.getChildAt=function(parent,index){return parent.children.item(index)};DOMBridge.prototype.getChildIndex=function(parent,target){for(var i=0,len=parent.children.length;i<len;i++){if(target===parent.children.item(i))return i}return-1};DOMBridge.prototype.getChildByName=function(parent,name){return parent.children.namedItem(name)};DOMBridge.prototype.getChildCount=function(parent){return parent.childElementCount};DOMBridge.prototype.loadAssets=function(assets,mediator,handler){if(assets)assets=assets.concat();loadNext();function loadNext(){if(!assets||assets.length<=0){handler()}else{var skin=assets.shift();AssetsManager_2.assetsManager.loadAssets(skin,function(result){if(result instanceof Error)handler(result);else loadNext()})}}};DOMBridge.prototype.mapListener=function(target,type,handler,thisArg){var key=ObjectUtil_1.getObjectHashs(target,type,handler,thisArg);if(this._listenerDict[key])return;var listener=function(evt){handler.call(thisArg||this,evt)};target.addEventListener(type,listener);this._listenerDict[key]=listener};DOMBridge.prototype.unmapListener=function(target,type,handler,thisArg){var key=ObjectUtil_1.getObjectHashs(target,type,handler,thisArg);var listener=this._listenerDict[key];if(listener){target.removeEventListener(type,listener);delete this._listenerDict[key]}};DOMBridge.prototype.wrapBindFor=function(target,handler){var parent=target.parentElement;var from=document.createElement("div");var to=document.createElement("div");parent&&parent.insertBefore(from,target);parent&&parent.insertBefore(to,target);parent&&parent.removeChild(target);return{parent:parent,from:from,to:to,handler:handler}};DOMBridge.prototype.valuateBindFor=function(target,datas,memento){var parent=memento.parent;if(parent){var fromIndex=this.getChildIndex(parent,memento.from);var toIndex=this.getChildIndex(parent,memento.to);for(var i=fromIndex+1;i<toIndex;i++){this.removeChildAt(parent,fromIndex+1)}}for(var key in datas){var newElement=target.cloneNode(true);parent&&parent.insertBefore(newElement,memento.to);memento.handler(key,datas[key],newElement)}};DOMBridge.TYPE="DOM";return DOMBridge}();exports.default=DOMBridge});